<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Models" href="../models/index.html" /><link rel="prev" title="Data split" href="data_split.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Helper functions - MLIP documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">MLIP  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">MLIP  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user_guide/index.html">User guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/data_processing.html">Data processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/training.html">Model training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/simulations.html">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/finetuning.html">Model fine-tuning</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">API reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Data processing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Data processing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="graph_dataset_builder.html">Graph Dataset Builder</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="chemical_systems_readers/index.html">Chemical System Readers</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Chemical System Readers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="chemical_systems_readers/chemical_systems_reader.html">Chemical Systems Reader: Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="chemical_systems_readers/extxyz_reader.html">Extxyz Reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="chemical_systems_readers/hdf5_reader.html">HDF5 Reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="chemical_systems_readers/combined_reader.html">Combined Reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="chemical_systems_readers/reader_utils.html">Reader Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="chemical_system.html">Chemical System</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataset_info.html">Dataset Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataset_configs.html">Dataset Configs</a></li>
<li class="toctree-l3"><a class="reference internal" href="atomic_number_table.html">Atomic Number Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph_definition.html">Graph Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph_dataset.html">Graph Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_prefetching.html">Data parallelization and batch prefetching</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_split.html">Data split</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Helper functions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../models/index.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/mlip_network.html">MLIP Network: Base Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/mace.html">MACE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/nequip.html">NequIP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/visnet.html">ViSNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/predictor.html">Force Field predictor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/force_field.html">Force Field</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/prediction.html">Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/io.html">Model I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/loss.html">Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/options.html">Model options: Enum classes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../training/index.html">Model training</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Model training</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../training/training_loop.html">Training Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/training_loop_config.html">Training Loop Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/training_state.html">Training state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/training_step.html">Training step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/optimizer.html">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/ema.html">Exponential Moving Average (EMA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/training_io_handling.html">IO handling during training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/evaluation.html">Model evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/finetuning.html">Fine-tuning utilities</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../simulation/index.html">Simulations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Simulations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../simulation/simulation_engine.html">Simulation Engine: Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/sim_config.html">Simulation Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/simulation_state.html">Simulation State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/enums.html">Simulation Enums</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/graph_from_atoms.html">Create graph from ASE atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/jaxmd_engine.html">JAX-MD Simulation Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/jaxmd_sim_config.html">JAX-MD Simulation Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/ase_engine.html">ASE Simulation Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/ase_calculator.html">MLIP ASE Calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/ase_sim_config.html">ASE Simulation Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/temperature_scheduling.html">Temperature scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulation/batched_inference.html">Batched inference</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/api_reference/data/helper_functions.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-mlip.data.helpers.graph_creation">
<span id="helper-functions"></span><span id="data-helper-functions"></span><h1>Helper functions<a class="headerlink" href="#module-mlip.data.helpers.graph_creation" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="mlip.data.helpers.graph_creation.create_graph_from_chemical_system">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.graph_creation.</span></span><span class="sig-name descname"><span class="pre">create_graph_from_chemical_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemical_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="chemical_system.html#mlip.data.chemical_system.ChemicalSystem" title="mlip.data.chemical_system.ChemicalSystem"><span class="pre">ChemicalSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_cutoff_angstrom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_it_with_minimal_dummy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GraphsTuple</span></span></span><a class="headerlink" href="#mlip.data.helpers.graph_creation.create_graph_from_chemical_system" title="Link to this definition">¶</a></dt>
<dd><p>Creates a jraph.GraphsTuple object from a chemical system object.</p>
<p>This includes computing the senders/receivers/shifts for the system and otherwise
just transferring data 1-to-1 to the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemical_system</strong> – The chemical system object.</p></li>
<li><p><strong>distance_cutoff_angstrom</strong> – The graph distance cutoff in Angstrom.</p></li>
<li><p><strong>batch_it_with_minimal_dummy</strong> – Batch the dummy together with a minimal dummy
graph of size 1 node and 1 edge. Needed if you
want to run a model inference on just this single
graph. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <code class="docutils literal notranslate"><span class="pre">jraph.GraphsTuple</span></code> object for the given chemical system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-mlip.data.helpers.neighborhood">
<dt class="sig sig-object py" id="mlip.data.helpers.neighborhood.get_neighborhood">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.neighborhood.</span></span><span class="sig-name descname"><span class="pre">get_neighborhood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlip.data.helpers.neighborhood.get_neighborhood" title="Link to this definition">¶</a></dt>
<dd><p>Computes the edge information for a given set of positions, including senders,
receivers, and shift vectors.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pbc</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">(False,</span> <span class="pre">False,</span> <span class="pre">False)</span></code>, then the shifts will be
returned as zero.
This is the default behavior. The cell is None as default and as a result, matscipy
will compute the minimal cell size needed to fit the whole system. See matscipy’s
documentation for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> – The position matrix.</p></li>
<li><p><strong>cutoff</strong> – The distance cutoff for the edges in Angstrom.</p></li>
<li><p><strong>pbc</strong> – A tuple of bools representing if periodic boundary conditions exist in
any of the spatial dimensions. Default is None, which means False in every
direction.</p></li>
<li><p><strong>cell</strong> – The unit cell of the system given as a 3x3 matrix or as None (default),
which means that matscipy will compute the minimal cell size needed to
fit the whole system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of <strong>senders</strong> (starting indexes of atoms for each edge), <strong>receivers</strong>
(ending indexes of atoms for each edge), and <strong>shifts</strong> (the shift vectors, see
matscipy’s documentation for more information. If PBCs are false,
then we return shifts of zero).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-mlip.data.helpers.edge_vectors">
<dt class="sig sig-object py" id="mlip.data.helpers.edge_vectors.get_edge_relative_vectors">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.edge_vectors.</span></span><span class="sig-name descname"><span class="pre">get_edge_relative_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">senders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#mlip.data.helpers.edge_vectors.get_edge_relative_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Compute the relative edge vectors from senders to receivers.</p>
<p>With PBCs, sender nodes need to be translated from the unit cell
to the receiver’s nearest neighbouring cell. See <a class="reference internal" href="#mlip.data.helpers.edge_vectors.get_edge_vectors" title="mlip.data.helpers.edge_vectors.get_edge_vectors"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_edge_vectors()</span></code></a>
for more details.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns vectors</span>
<span class="n">vectors</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">receivers</span><span class="p">]</span> <span class="o">-</span> <span class="n">positions</span><span class="p">[</span><span class="n">senders</span><span class="p">]</span> <span class="o">+</span> <span class="n">shifts</span> <span class="o">@</span> <span class="n">cell</span>
<span class="c1"># From the ASE docs:</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> – The positions of the system.</p></li>
<li><p><strong>senders</strong> – The sender indices of the edges, labelled <code class="code docutils literal notranslate"><span class="pre">i</span></code> by ASE.</p></li>
<li><p><strong>receivers</strong> – The receiver indices of the edges, labelled <code class="code docutils literal notranslate"><span class="pre">j</span></code> by ASE.</p></li>
<li><p><strong>shifts</strong> – The shift vectors as returned by the matscipy neighbour lists
functionality, and labelled <code class="code docutils literal notranslate"><span class="pre">S</span></code> by ASE.</p></li>
<li><p><strong>cell</strong> – The unit cells of each graph, an array of shape <code class="code docutils literal notranslate"><span class="pre">[n_graph,</span> <span class="pre">3,</span> <span class="pre">3]</span></code>.</p></li>
<li><p><strong>n_edge</strong> – The number of edges for each graph, an array of shape <code class="code docutils literal notranslate"><span class="pre">[n_graph]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The relative edge vectors, labelled <code class="code docutils literal notranslate"><span class="pre">D</span></code> by ASE.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlip.data.helpers.edge_vectors.get_edge_vectors">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.edge_vectors.</span></span><span class="sig-name descname"><span class="pre">get_edge_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">senders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlip.data.helpers.edge_vectors.get_edge_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Compute positions of sender and receiver nodes of each edge.</p>
<p>With periodic boundary conditions (PBCs), the receiver position
will remain unchanged and stay in the unit cell. The sender node’s
representative is translated from the unit cell to the nearest
neighbouring cell, by subtracting the shift (an integer-valued
vector counting lattice steps) multiplied by the 3x3 cell matrix.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns (vectors_senders, vectors_receivers)</span>
<span class="n">vectors_senders</span>   <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">shifts</span> <span class="o">@</span> <span class="n">cell</span>
<span class="n">vectors_receivers</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>The shift vectors therefore describe the number of boundary crossings
of the directed edge going from the sender to the receiver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> – The positions of the nodes.</p></li>
<li><p><strong>senders</strong> – The sender nodes of each edge.
Output <code class="code docutils literal notranslate"><span class="pre">i</span></code> of <code class="code docutils literal notranslate"><span class="pre">ase.neighborlist.primitive_neighbor_list</span></code>.</p></li>
<li><p><strong>receivers</strong> – The receiver nodes of each edge.
Output <code class="code docutils literal notranslate"><span class="pre">j</span></code> of <code class="code docutils literal notranslate"><span class="pre">ase.neighborlist.primitive_neighbor_list</span></code>.</p></li>
<li><p><strong>shifts</strong> – The shift vectors of each edge.
Output <code class="code docutils literal notranslate"><span class="pre">S</span></code> of <code class="code docutils literal notranslate"><span class="pre">ase.neighborlist.primitive_neighbor_list</span></code>.</p></li>
<li><p><strong>cell</strong> – The cell of each graph. Array of shape <code class="docutils literal notranslate"><span class="pre">[n_graph,</span> <span class="pre">3,</span> <span class="pre">3]</span></code>.</p></li>
<li><p><strong>n_edge</strong> – The number of edges of each graph. Array of shape <code class="docutils literal notranslate"><span class="pre">[n_graph]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The positions of the sender and receiver nodes of each edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-mlip.data.helpers.dynamically_batch">
<dt class="sig sig-object py" id="mlip.data.helpers.dynamically_batch.dynamically_batch">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.dynamically_batch.</span></span><span class="sig-name descname"><span class="pre">dynamically_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs_tuple_iterator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_last_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlip.data.helpers.dynamically_batch.dynamically_batch" title="Link to this definition">¶</a></dt>
<dd><p>Dynamically batches trees with <code class="docutils literal notranslate"><span class="pre">jraph.GraphsTuples</span></code> up to specified sizes.</p>
<p>Elements of the <code class="docutils literal notranslate"><span class="pre">graphs_tuple_iterator</span></code> will be incrementally added to a batch
until the limits defined by <code class="docutils literal notranslate"><span class="pre">n_node</span></code>, <code class="docutils literal notranslate"><span class="pre">n_edge</span></code> and <code class="docutils literal notranslate"><span class="pre">n_graph</span></code> are reached. This
means each element yielded by this generator may have a differing number of
graphs in its batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graphs_tuple_iterator</strong> – An iterator of <code class="docutils literal notranslate"><span class="pre">jraph.GraphsTuples</span></code>.</p></li>
<li><p><strong>n_node</strong> – The maximum number of nodes in a batch, at least the maximum sized
graph + 1.</p></li>
<li><p><strong>n_edge</strong> – The maximum number of edges in a batch, at least the maximum sized
graph.</p></li>
<li><p><strong>n_graph</strong> – The maximum number of graphs in a batch, at least 2.</p></li>
<li><p><strong>pad_fn</strong> – A function for padding. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default),
then use jraph.pad_with_graphs.</p></li>
<li><p><strong>skip_last_batch</strong> – Whether to skip the last batch. The default is false.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">jraph.GraphsTuple</span></code> batch of graphs.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – if the number of graphs is &lt; 2.</p></li>
<li><p><strong>RuntimeError</strong> – if the <code class="docutils literal notranslate"><span class="pre">graphs_tuple_iterator</span></code> contains elements which are not
    <code class="docutils literal notranslate"><span class="pre">jraph.GraphsTuple</span></code> objects.</p></li>
<li><p><strong>RuntimeError</strong> – if a graph is found which is larger than the batch size.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-mlip.data.helpers.dummy_init_graph">
<dt class="sig sig-object py" id="mlip.data.helpers.dummy_init_graph.get_dummy_graph_for_model_init">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.dummy_init_graph.</span></span><span class="sig-name descname"><span class="pre">get_dummy_graph_for_model_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GraphsTuple</span></span></span><a class="headerlink" href="#mlip.data.helpers.dummy_init_graph.get_dummy_graph_for_model_init" title="Link to this definition">¶</a></dt>
<dd><p>Generates a simple dummy graph that can be used for model initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dummy graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-mlip.data.helpers.atomic_energies">
<dt class="sig sig-object py" id="mlip.data.helpers.atomic_energies.compute_average_e0s_from_graphs">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.atomic_energies.</span></span><span class="sig-name descname"><span class="pre">compute_average_e0s_from_graphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mlip.data.helpers.atomic_energies.compute_average_e0s_from_graphs" title="Link to this definition">¶</a></dt>
<dd><p>Compute average energy contribution of each element by least squares.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graphs</strong> – The graphs for which to compute the average energy
contribution of each element</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The atomic energies dictionary which is the mapping of atomic species to
the average energy contribution of each element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-mlip.data.helpers.neighbor_analysis">
<dt class="sig sig-object py" id="mlip.data.helpers.neighbor_analysis.compute_avg_num_neighbors">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.neighbor_analysis.</span></span><span class="sig-name descname"><span class="pre">compute_avg_num_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#mlip.data.helpers.neighbor_analysis.compute_avg_num_neighbors" title="Link to this definition">¶</a></dt>
<dd><p>Computes the averages number of neighbors for a given list of graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graphs</strong> – The list of graphs to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The average (i.e., mean) number of neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlip.data.helpers.neighbor_analysis.compute_avg_min_neighbor_distance">
<span class="sig-prename descclassname"><span class="pre">mlip.data.helpers.neighbor_analysis.</span></span><span class="sig-name descname"><span class="pre">compute_avg_min_neighbor_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">GraphsTuple</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#mlip.data.helpers.neighbor_analysis.compute_avg_min_neighbor_distance" title="Link to this definition">¶</a></dt>
<dd><p>Computes the average minimum neighbor distance for a given list of graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graphs</strong> – The list of graphs to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The average (i.e., mean) minimum neighbor distance.</p>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../models/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Models</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="data_split.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Data split</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, InstaDeep
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Helper functions</a><ul>
<li><a class="reference internal" href="#mlip.data.helpers.graph_creation.create_graph_from_chemical_system"><code class="docutils literal notranslate"><span class="pre">create_graph_from_chemical_system()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.neighborhood.get_neighborhood"><code class="docutils literal notranslate"><span class="pre">get_neighborhood()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.edge_vectors.get_edge_relative_vectors"><code class="docutils literal notranslate"><span class="pre">get_edge_relative_vectors()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.edge_vectors.get_edge_vectors"><code class="docutils literal notranslate"><span class="pre">get_edge_vectors()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.dynamically_batch.dynamically_batch"><code class="docutils literal notranslate"><span class="pre">dynamically_batch()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.dummy_init_graph.get_dummy_graph_for_model_init"><code class="docutils literal notranslate"><span class="pre">get_dummy_graph_for_model_init()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.atomic_energies.compute_average_e0s_from_graphs"><code class="docutils literal notranslate"><span class="pre">compute_average_e0s_from_graphs()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.neighbor_analysis.compute_avg_num_neighbors"><code class="docutils literal notranslate"><span class="pre">compute_avg_num_neighbors()</span></code></a></li>
<li><a class="reference internal" href="#mlip.data.helpers.neighbor_analysis.compute_avg_min_neighbor_distance"><code class="docutils literal notranslate"><span class="pre">compute_avg_min_neighbor_distance()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>